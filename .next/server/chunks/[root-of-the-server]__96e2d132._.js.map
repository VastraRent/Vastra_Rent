{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 50, "column": 0}, "map": {"version":3,"sources":["file:///D:/PROJECT/vastrarent/src/lib/ai-config.ts"],"sourcesContent":["// AI Configuration for Vastra Rent Chatbot\r\nexport const AI_CONFIG = {\r\n  // Model settings - OpenRouter Dolphin Mistral model\r\n  model: 'cognitivecomputations/dolphin-mistral-24b-venice-edition:free', // Free Dolphin Mistral model\r\n  maxTokens: 2000,\r\n  temperature: 0.7,\r\n  frequencyPenalty: 0.1,\r\n  presencePenalty: 0.1,\r\n\r\n  // System prompt\r\n  systemPrompt: `You are Vastra Rent AI Assistant, powered by Dolphin Mistral AI, a helpful and knowledgeable assistant for a fashion rental platform called Vastra Rent. \r\n\r\nYour role is to help customers with:\r\n- Finding the perfect outfit for their occasions\r\n- Understanding rental policies and procedures\r\n- Providing fashion advice and styling tips\r\n- Answering questions about sizes, availability, and pricing\r\n- Helping with booking and rental processes\r\n- Suggesting alternatives and recommendations\r\n\r\nKey information about Vastra Rent:\r\n- We offer premium fashion rentals for special occasions\r\n- Our collection includes designer dresses, suits, accessories, and ethnic wear\r\n- Rental periods are typically 3-7 days\r\n- We provide cleaning and maintenance services\r\n- Free delivery and pickup within city limits\r\n- Size exchanges available if needed\r\n\r\nAlways be:\r\n- Friendly and professional\r\n- Fashion-forward and stylish in your advice\r\n- Helpful in finding solutions\r\n- Clear about policies and procedures\r\n- Encouraging customers to explore our collection\r\n\r\nIf you don't know specific details about inventory, pricing, or policies, politely direct customers to contact our support team or check the website for the most current information.`,\r\n\r\n  // Suggested prompts for users\r\n  suggestedPrompts: [\r\n    \"What dresses do you have for a wedding?\",\r\n    \"How does the rental process work?\",\r\n    \"Can you help me choose an outfit for a business event?\",\r\n    \"What are your rental policies?\",\r\n    \"Do you have ethnic wear for festivals?\",\r\n    \"What sizes are available?\",\r\n    \"How much does it cost to rent a dress?\",\r\n    \"Can I extend my rental period?\"\r\n  ]\r\n};"],"names":[],"mappings":"AAAA,2CAA2C;;;;AACpC,MAAM,YAAY;IACvB,oDAAoD;IACpD,OAAO;IACP,WAAW;IACX,aAAa;IACb,kBAAkB;IAClB,iBAAiB;IAEjB,gBAAgB;IAChB,cAAc,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;sLAyBqK,CAAC;IAErL,8BAA8B;IAC9B,kBAAkB;QAChB;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACD;AACH","debugId":null}},
    {"offset": {"line": 104, "column": 0}, "map": {"version":3,"sources":["file:///D:/PROJECT/vastrarent/src/app/api/chat/route.ts"],"sourcesContent":["import { createOpenAI } from '@ai-sdk/openai';\r\nimport { streamText } from 'ai';\r\nimport { NextRequest } from 'next/server';\r\nimport { AI_CONFIG } from '@/lib/ai-config';\r\n\r\nexport async function POST(req: NextRequest) {\r\n  try {\r\n    console.log('Chat API called');\r\n    \r\n    const body = await req.json();\r\n    console.log('Request body:', body);\r\n    \r\n    const { messages } = body;\r\n\r\n    // Validate the request\r\n    if (!messages || !Array.isArray(messages)) {\r\n      console.error('Invalid messages:', messages);\r\n      return new Response(JSON.stringify({ error: 'Invalid request: messages array is required' }), {\r\n        status: 400,\r\n        headers: { 'Content-Type': 'application/json' },\r\n      });\r\n    }\r\n\r\n    // Check if OpenRouter API key is configured\r\n    console.log('Environment check:');\r\n    console.log('OPENROUTER_API_KEY exists:', !!process.env.OPENROUTER_API_KEY);\r\n    console.log('OPENROUTER_API_KEY length:', process.env.OPENROUTER_API_KEY?.length);\r\n    \r\n    if (!process.env.OPENROUTER_API_KEY || process.env.OPENROUTER_API_KEY === 'your-openrouter-api-key-here') {\r\n      console.error('OpenRouter API key is not configured properly');\r\n      console.error('Current value:', process.env.OPENROUTER_API_KEY);\r\n      return new Response(JSON.stringify({ error: 'Service temporarily unavailable - OpenRouter API key not configured' }), {\r\n        status: 503,\r\n        headers: { 'Content-Type': 'application/json' },\r\n      });\r\n    }\r\n\r\n    console.log('API key configured, proceeding with OpenRouter call');\r\n\r\n    // Create OpenRouter client using OpenAI-compatible interface\r\n    const openrouter = createOpenAI({\r\n      name: 'openrouter',\r\n      apiKey: process.env.OPENROUTER_API_KEY!,\r\n      baseURL: 'https://openrouter.ai/api/v1',\r\n      headers: {\r\n        'HTTP-Referer': 'https://vastrarent.com', // Optional: your site URL\r\n        'X-Title': 'Vastra Rent AI Assistant', // Optional: your app name\r\n      },\r\n    });\r\n\r\n    // Add system prompt to the beginning of the conversation\r\n    const messagesWithSystem = [\r\n      { role: 'system', content: AI_CONFIG.systemPrompt },\r\n      ...messages,\r\n    ];\r\n\r\n    console.log('Messages with system prompt:', messagesWithSystem.length);\r\n    console.log('Using model:', AI_CONFIG.model);\r\n\r\n    console.log('About to call streamText with OpenRouter Dolphin Mistral...');\r\n    \r\n    const result = streamText({\r\n      model: openrouter(AI_CONFIG.model),\r\n      messages: messagesWithSystem,\r\n      maxTokens: AI_CONFIG.maxTokens,\r\n      temperature: AI_CONFIG.temperature,\r\n      frequencyPenalty: AI_CONFIG.frequencyPenalty,\r\n      presencePenalty: AI_CONFIG.presencePenalty,\r\n    });\r\n    \r\n    console.log('streamText call completed, result:', typeof result);\r\n\r\n    console.log('OpenRouter call successful, returning stream');\r\n    return result.toDataStreamResponse();\r\n  } catch (error) {\r\n    console.error('Chat API error:', error);\r\n    \r\n    // Handle specific OpenRouter errors\r\n    if (error instanceof Error) {\r\n      console.error('Error message:', error.message);\r\n      console.error('Error stack:', error.stack);\r\n      \r\n      if (error.message.includes('API key') || error.message.includes('Incorrect API key') || error.message.includes('invalid_api_key') || error.message.includes('unauthorized')) {\r\n        return new Response(JSON.stringify({ error: 'Authentication error - Invalid OpenRouter API key' }), { \r\n          status: 401,\r\n          headers: { 'Content-Type': 'application/json' },\r\n        });\r\n      }\r\n      if (error.message.includes('quota') || error.message.includes('exceeded') || error.message.includes('rate_limit')) {\r\n        return new Response(JSON.stringify({ error: 'Service quota exceeded' }), { \r\n          status: 429,\r\n          headers: { 'Content-Type': 'application/json' },\r\n        });\r\n      }\r\n      if (error.message.includes('model') || error.message.includes('not_found')) {\r\n        return new Response(JSON.stringify({ error: 'Model not available' }), { \r\n          status: 400,\r\n          headers: { 'Content-Type': 'application/json' },\r\n        });\r\n      }\r\n    }\r\n\r\n    return new Response(JSON.stringify({ error: 'Internal server error', details: error instanceof Error ? error.message : 'Unknown error' }), { \r\n      status: 500,\r\n      headers: { 'Content-Type': 'application/json' },\r\n    });\r\n  }\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}